; ***************************************************************************************
; ***************************************************************************************
;
;      Name :      support.asm
;      Authors :   Paul Robson (paul@robsons.org.uk)
;      Date :      23rd November 2023
;      Reviewed :  No
;      Purpose :   Support functions
;
; ***************************************************************************************
; ***************************************************************************************

; ***************************************************************************************
;
;							Write A to the current console
;
; ***************************************************************************************

KWriteCharacter:	
		pha
		jsr KWaitProcess
		sta $FF04
		lda #0
		sta $FF01
		lda #1
		sta $FF00
		pla
		rts

; ***************************************************************************************
;
;							Read keystroke from the console
;
; ***************************************************************************************

KReadCharacter:
		jsr 	KWaitProcess
		lda 	#1
		sta		$FF01
		sta 	$FF00
		jsr 	KWaitProcess
		lda 	$FF04
		beq 	KReadCharacter
		rts

; ***************************************************************************************
;
;			Wait for the handler process to acknowledge or return a value
;
; ***************************************************************************************

KWaitProcess:
	pha
KWaitProcess1:
	lda $FF00
	bne KWaitProcess1
	pla
	rts
	